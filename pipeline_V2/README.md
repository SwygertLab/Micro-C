# MicroC_V2.sh
MicroC_V2.sh does the same tasks as the first version, but it has more organization of files overall. It also, contains better log files containing 
information like the time it took each command to run. 

A couple packages are needed to run this code all of which are downloadable from https://anaconda.org/anaconda/conda including:
- python version 3.8+
- cooltools
- pairtools
- numpy
- matplotlib

The variables input_dir, scripts_dir, and output_dir need to contain absolute paths as to where you want certain files to be outputted. 

The input_dir is not essential and I mainly use it as a working directory where I call the scripts from, but the input_dir variable is helpful when I run a script to delete all the non-essentail intermediate files. It typically holds my metadata file and the 2 pair-end Micro-C data files. The scripts_dir variable usually points to a directory that holds MicroC_V2.sh, separate_by_orientation.py, and distance_decay.py. The output_dir variable directory does not assume there are any files at that location just that it exists, and will create another output directory inside the specified directory. I chose to do it this way as I often run the same dataset under different conditions and I can change the new output variable name to those conditions or just keep it as the new date and write notes in the respective locations specifying what the different conditions were. 

On lines 80-107 there is a section that includes the variable that need to be changed for the user's needs. 

Line 81 should be your own conda environment.

Line 84 should be where point to your metadata file and can be passed in as an argument or just set it to the absolute path. The only requirements for the
metadata file is that on the first line in a whitespace delimited manner is first the forward read of your micro-c paired end data, second the reverse read
of your paired end data, and third the prefix for the files that will be generated by this script. An example is included called metadata_example.txt.

Line 87 points to your genome data. Line 90 points to your chromosome sizes file. An example of what the chromosome sizes file should look like will be included
under example_sacCer3.chrSizes. 

Line 92 should be the absolute path to your juicer jar file location. In order, for the java jar commands to work you need to download a jar file from the aiden lab github here: 
https://github.com/aidenlab/juicer/wiki/Download 
The version used at the creation of this script is juicer_tools_1.22.01.jar

If you keep line 94 and # out line 96 then an output folder will be made in your system calendar's date_output. If you keep line 96 and # out line 94 then
you should hardset the date you want the output folder prefix to be labeled as.

Line 97 should be the path to where you want your fastq files to be held. The script will create the input directory called 01_input_data and move your fastq files into it.
Line 98 should be the path to where you want your scripts to be. These scripts include this MicroC_V2.sh, filter_orientation_heading.py, and distance_decay.py.
Assuming they are currently in your working directory this script will create a scripts directory at the location placed in line 98 called 02_scripts and move
the 3 scripts into it. 
Line 99 and line 116 should be the path and directory name to where you want the results from this directory to go. For some additional organization. This script creates
an output directory called 03_results and in their another directory called "date"_output. I use this to allow for multiple sets of analysis settings for the same dateset
and keep using the same intial files and keep them in the same experiment folder. 
If you prefer creating your own input, scripts and output directory, then you still need to point to where your they are on line 97, line 98, and line 99, but delete lines 114, 
115, 116, 127, 128, 129, 130, and line 131. Then call this script from your input directory.

Please also change lines 3 through 9 as needed. 

To call this script you can call the following from your experiment directory that needs to include this MicroC_V2.sh, filter_orientation_heading.py, distance_decay.py, your
metadata file, and your 2 fastq files:

sbatch MicroC_V2.sh metadata_file.txt

To call this script assuming you made your own input, scripts, and output directory you can call this from your input directory containing your 2 fastq files and your metadata
file and your scripts directory has MicroC_V2.sh, filter_orientation_heading.py, and distance_decay.py like this:
sbatch ../02_scripts/MicroC_V2.sh metadata.txt

## Versions of packages used at time of Writing this

You can download the packages using these installation commands:

conda install -c bioconda bowtie2

conda install python=3.8

conda install -c conda-forge matplotlib-base

conda install -c bioconda cooltools

conda install -c conda-forge -c bioconda pairtools=0.3.0 python=3.8
